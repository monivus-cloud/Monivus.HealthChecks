{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Monivus.HealthChecks","text":"<p>Lightweight health checks for ASP.NET Core with a clean JSON response and optional remote aggregation.</p> <p>What you'll find here: - Quick start and examples below</p>"},{"location":"#install-packages","title":"Install Packages","text":"<p>Install the core package and only the checks you need:</p> <pre><code>dotnet add package Monivus.HealthChecks\ndotnet add package Monivus.HealthChecks.System\ndotnet add package Monivus.HealthChecks.SqlServer\ndotnet add package Monivus.HealthChecks.Redis\ndotnet add package Monivus.HealthChecks.Url\n</code></pre>"},{"location":"#quick-start","title":"Quick Start","text":"coderesponse example <pre><code>using Monivus.HealthChecks;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Register health checks you need\nbuilder.Services.AddHealthChecks()\n    .AddSystemEntry()\n    .AddSqlServerEntry()\n    .AddRedisEntry()\n    .AddUrlEntry(\"Google\");\n\nvar app = builder.Build();\n\n// Expose default JSON endpoint at /health\napp.UseMonivusHealthChecks(\"/health\");\n\napp.Run();\n</code></pre> <p>Example response from a local <code>/health</code> endpoint:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"timestamp\": \"2024-11-07T21:35:42.512Z\",\n  \"duration\": \"00:00:00.0230000\",\n  \"durationMs\": 23,\n  \"traceId\": \"0HMG4H6P9A2Q1:00000001\",\n  \"entries\": {\n    \"SqlServer\": {\n      \"status\": \"Healthy\",\n      \"description\": \"SqlServer is healthy and running.\",\n      \"duration\": \"00:00:00.0100000\",\n      \"durationMs\": 10,\n      \"data\": {\n        \"connectionTimeout\": 15,\n        \"state\": 1,\n        \"commandTimeout\": 30,\n        \"connectionOpenMilliseconds\": 3.21,\n        \"queryDurationMilliseconds\": 1.45\n      },\n      \"exception\": null,\n      \"tags\": [\"SqlServer\", \"db\"],\n      \"entryType\": \"SqlServer\"\n    },\n    \"Redis\": {\n      \"status\": \"Degraded\",\n      \"description\": \"Redis ping exceeded threshold (210ms).\",\n      \"duration\": \"00:00:00.0040000\",\n      \"durationMs\": 4,\n      \"data\": {\n        \"isConnected\": true,\n        \"serverVersion\": \"7.2.4\",\n        \"serverType\": \"Standalone\",\n        \"pingMilliseconds\": 210,\n        \"databaseSize\": 1024\n      },\n      \"exception\": null,\n      \"tags\": [\"Redis\"],\n      \"entryType\": \"Redis\"\n    },\n  }\n}\n</code></pre>"},{"location":"#aggregated-checks","title":"Aggregated Checks","text":"<p>Optionally expose an aggregated endpoint that merges local + remote services</p> coderesponse example <pre><code>using Monivus.HealthChecks;\n\n// instead of UseMonivusHealthChecks\napp.UseMonivusAggregatedHealthChecks(options =&gt;\n{\n    options.AddEndpoint(\"https://service-a.example.com/health\", name: \"service-a\");\n    options.AddEndpoint(\"https://service-b.example.com/health\", name: \"service-b\");\n}, path: \"/healthz\");\n\napp.Run();\n</code></pre> <p>Example response from an aggregated endpoint (e.g., <code>/healthz</code>) that merges local checks plus two remotes:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"timestamp\": \"2024-11-07T21:36:12.101Z\",\n  \"duration\": \"00:00:00.0450000\",\n  \"durationMs\": 45,\n  \"traceId\": \"0HMG4H6P9A2Q2:00000002\",\n  \"entries\": {\n    \"System\": { \"status\": \"Healthy\", \"description\": \"System utilization within defined thresholds.\", \"duration\": \"00:00:00.0010000\", \"durationMs\": 1, \"data\": null, \"exception\": null, \"tags\": [\"System\"], \"entryType\": \"System\" },\n\n    \"service-a\": { \"status\": \"Healthy\", \"description\": null, \"duration\": \"00:00:00.0200000\", \"durationMs\": 20, \"data\": { \"statusCode\": 200 }, \"exception\": null, \"tags\": [], \"entryType\": \"Service\" },\n    \"service-a|System\": { \"status\": \"Healthy\", \"description\": \"System utilization within defined thresholds.\", \"duration\": \"00:00:00.0010000\", \"durationMs\": 1, \"data\": null, \"exception\": null, \"tags\": [\"System\"], \"entryType\": \"System\" },\n    \"service-a|SqlServer\": { \"status\": \"Healthy\", \"description\": \"SqlServer is healthy and running.\", \"duration\": \"00:00:00.0100000\", \"durationMs\": 10, \"data\": { \"connectionOpenMilliseconds\": 3.1, \"queryDurationMilliseconds\": 1.2 }, \"exception\": null, \"tags\": [\"SqlServer\"], \"entryType\": \"SqlServer\" },\n\n    \"service-b\": { \"status\": \"Unhealthy\", \"description\": \"Request timed out.\", \"duration\": \"00:00:00.5000000\", \"durationMs\": 500, \"data\": { \"statusCode\": 504 }, \"exception\": \"System.Threading.Tasks.TaskCanceledException\", \"tags\": [], \"entryType\": \"Service\" }\n  }\n}\n</code></pre> <p>Entries diagram example: <pre><code>graph LR\n  A[Application] --&gt; E1[Redis];\n  A --&gt; E2[URL];\n  A --&gt; SA[Service A]\n  A --&gt; SB[Service B]\n  SA --&gt; E3[Sql Server]\n  SA --&gt; E4[Hangfire]\n  SB --&gt; E5[Postgres]</code></pre></p>"},{"location":"#configuration-hints","title":"Configuration Hints","text":"<p>You can configure most options via <code>appsettings.json</code>:</p> <pre><code>{\n  \"ConnectionStrings\": {\n    \"DefaultConnection\": \"Server=.;Database=MyDb;Trusted_Connection=True;\"\n  },\n  \"Monivus\": {\n    \"SqlServer\": {\n      \"ConnectionStringOrName\": \"DefaultConnection\"\n    },\n    \"Redis\": {\n      \"ConnectionString\": \"localhost:6379\"\n    },\n    \"Urls\": {\n      \"Google\": { \"Url\": \"https://www.google.com\" }\n    },\n    \"System\": {\n      \"MemoryUsageThresholdPercent\": 85\n    },\n    \"Hangfire\": {\n      \"MinServers\": 1,\n      \"MaxFailedJobs\": 10,\n      \"MaxEnqueuedJobs\": 1000\n    }\n  }\n}\n</code></pre>"},{"location":"#conventions","title":"Conventions","text":"<ul> <li>Property names are camelCase; <code>status</code> values are strings (e.g., \"Healthy\").</li> <li><code>duration</code> is an ISO-like TimeSpan string; <code>durationMs</code> is numeric and rounded.</li> <li><code>entries</code> are keyed by registration name; aggregated remotes prefix entries with <code>{remoteName}|</code> and include a summary entry per remote.</li> </ul>"},{"location":"exporter/","title":"Monivus Exporter","text":"<p>Exports your app's health check report to a central endpoint on a schedule.</p> <p>What it does:</p> <ul> <li>Periodically GETs your local health endpoint (JSON).</li> <li>POSTs the same JSON to your Monivus Cloud URL (or any you have).</li> <li>Uses a lightweight hosted background service with configurable interval and timeout.</li> </ul>"},{"location":"exporter/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.Exporter\n</code></pre>"},{"location":"exporter/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nvar builder = WebApplication.CreateBuilder(args);\n\n// Register exporter (binds Monivus:Exporter)\nbuilder.Services.AddMonivusExporter(builder.Configuration);\n\n// Typical health endpoint exposed for the exporter to read\nvar app = builder.Build();\napp.UseMonivusHealthChecks(\"/health\");\napp.Run();\n</code></pre>"},{"location":"exporter/#standalone-host-servicecontainer","title":"Standalone host (service/container)","text":"<p>If you prefer not to wire the exporter inside your app, use the standalone host in <code>src/Monivus.Exporter</code>:</p> <ul> <li>Run locally: <code>dotnet run --project src/Monivus.Exporter</code></li> <li>Windows service: publish then install <code>MonivusExporter</code> pointing to the published <code>Monivus.Exporter.exe</code></li> <li>systemd: run <code>/usr/bin/dotnet /opt/monivus-exporter/Monivus.Exporter.dll</code></li> <li>Docker: <code>docker build -f src/Monivus.Exporter/Dockerfile -t ghcr.io/&lt;owner&gt;/monivus-exporter:local .</code></li> <li>ENV overrides in containers/services:</li> <li><code>Monivus__Exporter__ApplicationHealthCheckUrl</code></li> <li><code>Monivus__Exporter__MonivusCloudUrl</code> (e.g., <code>https://cloud.monivus.com/api</code>)</li> <li><code>Monivus__Exporter__ApiKey</code></li> </ul>"},{"location":"exporter/#configuration","title":"Configuration","text":"<p>Binding path: <code>Monivus:Exporter</code></p> <p>Keys:</p> <ul> <li><code>Enabled</code> (bool, default true): Turns exporter on/off.</li> <li><code>ApplicationHealthCheckUrl</code> (string, required): Absolute URL to your app's health endpoint (e.g., <code>https://api.example.com/health</code>).</li> <li><code>MonivusCloudUrl</code> (string, required): Absolute URL to receive payloads (e.g., <code>https://cloud.monivus.com/api</code>).</li> <li><code>ApiKey</code> (string, optional): Sent as <code>Authorization: ApiKey {value}</code>.</li> <li><code>CheckInterval</code> (int, minutes, default 1): Interval between export cycles.</li> <li><code>HttpTimeout</code> (TimeSpan, default 00:00:30): Timeout for GET and POST.</li> </ul> <p>Example:</p> <pre><code>{\n  \"Monivus\": {\n    \"Exporter\": {\n      \"Enabled\": true,\n      \"ApplicationHealthCheckUrl\": \"https://your-app.example.com/health\",\n      \"MonivusCloudUrl\": \"https://cloud.monivus.com/api\",\n      \"ApiKey\": \"YOUR_API_KEY\",\n      \"CheckInterval\": 1,\n      \"HttpTimeout\": \"00:00:30\"\n    }\n  }\n}\n</code></pre>"},{"location":"exporter/#behavior","title":"Behavior","text":"<ul> <li>Schedule: runs every <code>CheckInterval</code> minutes; waits even when disabled.</li> <li>Fetch: GETs <code>ApplicationHealthCheckUrl</code> with <code>Accept: application/json</code>.</li> <li>Accepts 2xx as success; logs warning and skips on non-2xx except 503 (Service Unavailable), which is tolerated.</li> <li>Send: POSTs to <code>MonivusCloudUrl</code> with <code>Content-Type: application/json</code>.</li> <li>Adds <code>Authorization: ApiKey {ApiKey}</code> when configured.</li> <li>On 401 responses, increments an internal counter and stops after 20 consecutive 401s.</li> <li>Serialization: Uses camelCase, enum strings, ignores nulls; payload shape matches the standard Monivus health response.</li> </ul>"},{"location":"exporter/#payload-example","title":"Payload Example","text":"<p>The exporter posts a <code>HealthCheckReport</code> JSON identical to your <code>/health</code> response. See full samples in: <code>docs/index.md</code>.</p> <p>Short example (truncated):</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"timestamp\": \"2024-11-07T21:35:42.512Z\",\n  \"duration\": \"00:00:00.0230000\",\n  \"durationMs\": 23,\n  \"traceId\": \"0H...:0001\",\n  \"entries\": {\n    \"System\": { \"status\": \"Healthy\", \"durationMs\": 1, \"entryType\": \"System\" },\n    \"SqlServer\": { \"status\": \"Healthy\", \"durationMs\": 10, \"entryType\": \"SqlServer\" }\n  }\n}\n</code></pre>"},{"location":"exporter/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>401 Unauthorized: verify <code>ApiKey</code>; exporter stops after 20 consecutive 401s.</li> <li>Invalid URLs: both URLs must be absolute; misconfigurations are logged and the cycle is skipped.</li> <li>Timeouts: adjust <code>HttpTimeout</code> if your health check or network is slow.</li> <li>Service Unavailable (503): considered a valid health read; payload still forwarded.</li> </ul>"},{"location":"health-checks/hangfire/","title":"Hangfire Health Check","text":"<p>Monitors Hangfire server health and queue conditions via the Hangfire monitoring API.</p> <p>Status rules:</p> <ul> <li>Healthy when storage is accessible and all configured thresholds are satisfied.</li> <li>Degraded when any threshold is violated:</li> <li><code>Failed</code> jobs &gt; <code>MaxFailedJobs</code></li> <li><code>Enqueued</code> jobs &gt; <code>MaxEnqueuedJobs</code></li> <li>Registered servers &lt; <code>MinServers</code></li> <li>Unhealthy when storage/connection is inaccessible or an exception occurs.</li> </ul>"},{"location":"health-checks/hangfire/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.Hangfire\n</code></pre>"},{"location":"health-checks/hangfire/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddHangfireEntry(name: \"Hangfire\");\n</code></pre> <p>Requires Hangfire <code>JobStorage</code> to be configured (e.g., SQL Server storage). The check resolves <code>JobStorage</code> from DI or uses <code>JobStorage.Current</code>.</p>"},{"location":"health-checks/hangfire/#configuration","title":"Configuration","text":"<p>Binding path: <code>Monivus:Hangfire</code></p>"},{"location":"health-checks/hangfire/#minservers","title":"MinServers","text":"<p>Minimum number of registered servers required. Degraded when actual is less than this value.</p> <pre><code>{\n  \"Monivus\": { \"Hangfire\": { \"MinServers\": 1 } }\n}\n</code></pre>"},{"location":"health-checks/hangfire/#maxfailedjobs","title":"MaxFailedJobs","text":"<p>Maximum allowed failed jobs. Degraded when the current <code>Failed</code> count exceeds this value.</p> <pre><code>{\n  \"Monivus\": { \"Hangfire\": { \"MaxFailedJobs\": 10 } }\n}\n</code></pre>"},{"location":"health-checks/hangfire/#maxenqueuedjobs","title":"MaxEnqueuedJobs","text":"<p>Maximum allowed enqueued jobs. Degraded when the current <code>Enqueued</code> count exceeds this value.</p> <pre><code>{\n  \"Monivus\": {\n    \"Hangfire\": {\n      \"MinServers\": 1,\n      \"MaxFailedJobs\": 10,\n      \"MaxEnqueuedJobs\": 1000\n    }\n  }\n}\n</code></pre> <p>Example interpretation: if there is at least 1 server, fewer than or equal to 10 failed jobs, and at most 1000 enqueued jobs, the check reports Healthy; otherwise Degraded. Storage connectivity issues result in Unhealthy.</p>"},{"location":"health-checks/hangfire/#example-entry-json","title":"Example Entry (JSON)","text":"<p><code>entries.Hangfire</code> inside the <code>/health</code> response when Healthy:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"Hangfire is healthy and running\",\n  \"duration\": \"00:00:00.0030000\",\n  \"durationMs\": 3,\n  \"data\": {\n    \"totalServers\": 2,\n    \"succeededJobs\": 1500,\n    \"failedJobs\": 4,\n    \"processingJobs\": 2,\n    \"scheduledJobs\": 5,\n    \"enqueuedJobs\": 20,\n    \"deletedJobs\": 0,\n    \"recurringJobs\": 12,\n    \"lastServerHeartbeat\": \"2024-11-07T21:30:00.123Z\"\n  },\n  \"exception\": null,\n  \"tags\": [\"Hangfire\"],\n  \"entryType\": \"Hangfire\"\n}\n</code></pre>"},{"location":"health-checks/oracle/","title":"Oracle Health Check","text":"<p>Executes a lightweight scalar query to verify connectivity and responsiveness to an Oracle database using Oracle.ManagedDataAccess.</p> <p>Status rules:</p> <ul> <li>Healthy when the connection can be opened and the test command returns a non-null scalar result.</li> <li>Unhealthy when connection open, command execution, or the test query result fails.</li> <li>This check does not emit Degraded; prefer external SLAs or logging for latency thresholds.</li> </ul>"},{"location":"health-checks/oracle/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.Oracle\n</code></pre>"},{"location":"health-checks/oracle/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddOracleEntry(name: \"Oracle\", tags: new[] { \"db\" });\n</code></pre> <p>Configuration binding path: <code>Monivus:Oracle</code></p>"},{"location":"health-checks/oracle/#configuration","title":"Configuration","text":""},{"location":"health-checks/oracle/#connectionstringorname","title":"ConnectionStringOrName","text":"<p>Gets or sets the Oracle connection string or the name of a connection string.</p> <pre><code>{\n  \"ConnectionStrings\": {\n    \"OracleDb\": \"User Id=myuser;Password=mypassword;Data Source=localhost/FREEPDB1\"\n  },\n  \"Monivus\": {\n    \"Oracle\": { \"ConnectionStringOrName\": \"OracleDb\" }\n  }\n}\n</code></pre>"},{"location":"health-checks/oracle/#commandtext","title":"CommandText","text":"<p>Gets or sets the SQL command text to execute. Defaults to <code>SELECT 1 FROM DUAL</code> and should remain extremely cheap.</p> <pre><code>{\n  \"Monivus\": { \"Oracle\": { \"CommandText\": \"SELECT 1 FROM DUAL\" } }\n}\n</code></pre>"},{"location":"health-checks/oracle/#commandtimeout","title":"CommandTimeout","text":"<p>Gets or sets the command timeout in seconds. When exceeded, the check returns Unhealthy with the timeout exception.</p> <pre><code>{\n  \"Monivus\": { \"Oracle\": { \"CommandTimeout\": 5 } }\n}\n</code></pre> <p>Example interpretation: if the connection opens and the query returns promptly, the check reports Healthy. Any connection failure, timeout, or unexpected result reports Unhealthy.</p>"},{"location":"health-checks/oracle/#example-entry-json","title":"Example Entry (JSON)","text":"<p><code>entries.Oracle</code> inside the <code>/health</code> response when Healthy:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"Oracle is healthy and running.\",\n  \"duration\": \"00:00:00.0120000\",\n  \"durationMs\": 12,\n  \"data\": {\n    \"connectionTimeout\": 15,\n    \"state\": 1,\n    \"commandTimeout\": 30,\n    \"connectionOpenMilliseconds\": 4.02,\n    \"queryDurationMilliseconds\": 1.81\n  },\n  \"exception\": null,\n  \"tags\": [\"Oracle\", \"db\"],\n  \"entryType\": \"Oracle\"\n}\n</code></pre>"},{"location":"health-checks/postgresql/","title":"PostgreSQL Health Check","text":"<p>Executes a lightweight SQL command to verify connectivity and responsiveness to a PostgreSQL database via Npgsql.</p> <p>Status rules:</p> <ul> <li>Healthy when the connection can be opened and the test command returns a non-null scalar result.</li> <li>Unhealthy when connection open, command execution, or the test result fails.</li> <li>This check does not report Degraded; consider using external SLAs or logs for latency thresholds.</li> </ul>"},{"location":"health-checks/postgresql/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.PostgreSql\n</code></pre>"},{"location":"health-checks/postgresql/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddPostgreSqlEntry(name: \"PostgreSql\", tags: new[] { \"db\" });\n</code></pre> <p>Configuration binding path: <code>Monivus:PostgreSql</code></p>"},{"location":"health-checks/postgresql/#configuration","title":"Configuration","text":""},{"location":"health-checks/postgresql/#connectionstringorname","title":"ConnectionStringOrName","text":"<p>Gets or sets the PostgreSQL connection string or the name of a connection string.</p> <pre><code>{\n  \"ConnectionStrings\": {\n    \"Pg\": \"Host=localhost;Port=5432;Database=mydb;Username=myuser;Password=mypassword\"\n  },\n  \"Monivus\": {\n    \"PostgreSql\": { \"ConnectionStringOrName\": \"Pg\" }\n  }\n}\n</code></pre>"},{"location":"health-checks/postgresql/#commandtext","title":"CommandText","text":"<p>Gets or sets the SQL command text to be executed for the health check. Should be a very cheap scalar query (e.g., <code>SELECT 1</code>).</p> <pre><code>{\n  \"Monivus\": { \"PostgreSql\": { \"CommandText\": \"SELECT 1\" } }\n}\n</code></pre>"},{"location":"health-checks/postgresql/#commandtimeout","title":"CommandTimeout","text":"<p>Gets or sets the command timeout in seconds for the SQL command. If the command exceeds this timeout, the check returns Unhealthy with the corresponding exception.</p> <pre><code>{\n  \"Monivus\": { \"PostgreSql\": { \"CommandTimeout\": 5 } }\n}\n</code></pre> <p>Example interpretation: if connecting runs and <code>SELECT 1</code> returns promptly, the check reports Healthy. If connecting or executing fails or times out, the check reports Unhealthy.</p>"},{"location":"health-checks/postgresql/#example-entry-json","title":"Example Entry (JSON)","text":"<p><code>entries.PostgreSql</code> inside the <code>/health</code> response when Healthy:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"PostgreSQL is healthy and running.\",\n  \"duration\": \"00:00:00.0100000\",\n  \"durationMs\": 10,\n  \"data\": {\n    \"connectionTimeout\": 15,\n    \"state\": 1,\n    \"commandTimeout\": 30,\n    \"connectionOpenMilliseconds\": 3.21,\n    \"queryDurationMilliseconds\": 1.45\n  },\n  \"exception\": null,\n  \"tags\": [\"PostgreSql\", \"db\"],\n  \"entryType\": \"PostgreSql\"\n}\n</code></pre>"},{"location":"health-checks/redis/","title":"Redis Health Check","text":"<p>Pings Redis and evaluates responsiveness. Also collects useful metrics (clients, memory, ops/sec, etc.).</p>"},{"location":"health-checks/redis/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.Redis\n</code></pre>"},{"location":"health-checks/redis/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddRedisEntry(name: \"Redis\");\n</code></pre> <p>If not providing a connection string in configuration, ensure an <code>IConnectionMultiplexer</code> is registered.</p>"},{"location":"health-checks/redis/#configuration","title":"Configuration","text":"<p>Binding path: <code>Monivus:Redis</code></p>"},{"location":"health-checks/redis/#connectionstring","title":"ConnectionString","text":"<p>Gets or sets the Redis connection string.</p> <pre><code>{\n  \"Monivus\": {\n    \"Redis\": { \n        \"ConnectionString\": \"localhost:6379\" \n        } \n    }\n}\n</code></pre>"},{"location":"health-checks/redis/#slowpingthresholdmilliseconds","title":"SlowPingThresholdMilliseconds","text":"<p>Threshold in milliseconds for considering a Redis PING as slow.</p> <p>Status rules:</p> <ul> <li>Healthy when the PING completes and (if set) the latency is less than or equal to the threshold.</li> <li>Degraded when the measured PING latency is greater than the threshold.</li> <li>Unhealthy when the connection is not established, there are no endpoints, or exceptions occur.</li> </ul> <pre><code>{\n  \"Monivus\": {\n    \"Redis\": {\n      \"ConnectionString\": \"localhost:6379\",\n      \"SlowPingThresholdMilliseconds\": 200\n    }\n  }\n}\n</code></pre> <p>Example interpretation: if a <code>PING</code> takes above 200 ms, the check reports Degraded; at or below 200 ms it\u2019s Healthy. Connection or command errors result in Unhealthy.</p>"},{"location":"health-checks/redis/#admin-mode-allowadmin","title":"Admin Mode (AllowAdmin)","text":"<p>Some extended metrics are retrieved via the Redis <code>INFO</code> command. In StackExchange.Redis this is treated as a server/admin operation. If the connection has admin operations disabled (<code>AllowAdmin = false</code>, which is the default) or the command is unavailable, attempting to call <code>server.InfoAsync()</code> may throw.</p> <p>This health check handles that gracefully:</p> <ul> <li>It still performs a <code>PING</code> and basic probes (e.g., server info, DB size, last save) and reports Healthy/Degraded based on latency and connectivity.</li> <li>When admin is not allowed, it returns Healthy with limited data and the description includes a hint: <code>Redis is healthy and responsive. (Admin not allowed!)</code>.</li> <li>Extended metrics (memory usage breakdown, connected clients, ops/sec, hit/miss, etc.) are omitted in this mode.</li> </ul> <p>To enable extended metrics, allow admin commands for the connection used by the health check:</p> <pre><code># Connection string option\nlocalhost:6379,allowAdmin=true\n</code></pre> <pre><code>// ConfigurationOptions example\nvar opts = ConfigurationOptions.Parse(\"localhost:6379\");\nopts.AllowAdmin = true;\nvar mux = await ConnectionMultiplexer.ConnectAsync(opts);\n\nbuilder.Services.AddSingleton&lt;IConnectionMultiplexer&gt;(mux);\nbuilder.Services.AddHealthChecks().AddRedisEntry(\"Redis\");\n</code></pre> <p>Tip: If you prefer to keep application connections non-admin, you can maintain a separate admin-enabled multiplexer registered only for health/metrics.</p>"},{"location":"health-checks/redis/#example-entries-json","title":"Example Entries (JSON)","text":"<p>Below are example payloads for <code>entries.Redis</code> as returned by the <code>/health</code> endpoint.</p> <p>Healthy with admin enabled (full metrics):</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"Redis is healthy and responsive.\",\n  \"duration\": \"00:00:00.0030000\",\n  \"durationMs\": 3,\n  \"data\": {\n    \"IsConnected\": true,\n    \"ServerVersion\": \"7.2.4\",\n    \"ServerType\": \"Standalone\",\n    \"PingMilliseconds\": 12,\n    \"DatabaseSize\": 2048,\n    \"LastSaveUtc\": \"2024-06-12T08:21:45.0000000Z\",\n    \"UsedMemoryMb\": 128.5,\n    \"UsedMemoryRssMb\": 140.1,\n    \"TotalSystemMemoryMb\": 16384,\n    \"MemoryUsagePercent\": 0.78,\n    \"ConnectedClients\": 5,\n    \"BlockedClients\": 0,\n    \"OpsPerSecond\": 342,\n    \"UptimeSeconds\": 86400,\n    \"MemoryFragmentationRatio\": 1.07,\n    \"KeyspaceHits\": 15000,\n    \"KeyspaceMisses\": 500,\n    \"KeyspaceHitRatePercent\": 96.77\n  },\n  \"exception\": null,\n  \"tags\": [\"Redis\"],\n  \"entryType\": \"Redis\"\n}\n</code></pre> <p>Healthy with admin disabled (limited metrics):</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"Redis is healthy and responsive. (Admin not allowed!)\",\n  \"duration\": \"00:00:00.0020000\",\n  \"durationMs\": 2,\n  \"data\": {\n    \"IsConnected\": true,\n    \"ServerVersion\": \"7.2.4\",\n    \"ServerType\": \"Standalone\",\n    \"PingMilliseconds\": 10,\n    \"DatabaseSize\": 1024,\n    \"LastSaveUtc\": \"2024-06-12T08:21:45.0000000Z\"\n  },\n  \"exception\": null,\n  \"tags\": [\"Redis\"],\n  \"entryType\": \"Redis\"\n}\n</code></pre> <p>Degraded when ping exceeds threshold (no extended metrics, matches current implementation order):</p> <pre><code>{\n  \"status\": \"Degraded\",\n  \"description\": \"Redis ping exceeded threshold (210ms).\",\n  \"duration\": \"00:00:00.0040000\",\n  \"durationMs\": 4,\n  \"data\": {\n    \"IsConnected\": true,\n    \"ServerVersion\": \"7.2.4\",\n    \"ServerType\": \"Standalone\",\n    \"PingMilliseconds\": 210,\n    \"DatabaseSize\": 1024,\n    \"LastSaveUtc\": \"2024-06-12T08:21:45.0000000Z\"\n  },\n  \"exception\": null,\n  \"tags\": [\"Redis\"],\n  \"entryType\": \"Redis\"\n}\n</code></pre>"},{"location":"health-checks/sqlserver/","title":"SQL Server Health Check","text":"<p>Executes a lightweight SQL command to verify connectivity and responsiveness.</p> <p>Status rules:</p> <ul> <li>Healthy when the connection can be opened and the test command returns a non-null scalar result.</li> <li>Unhealthy when connection open, command execution, or the test result fails.</li> <li>This check does not report Degraded; consider using external SLAs or logs for latency thresholds.</li> </ul>"},{"location":"health-checks/sqlserver/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.SqlServer\n</code></pre>"},{"location":"health-checks/sqlserver/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddSqlServerEntry(name: \"SqlServer\", tags: new[] { \"db\" });\n</code></pre> <p>Configuration binding path: <code>Monivus:SqlServer</code></p>"},{"location":"health-checks/sqlserver/#configuration","title":"Configuration","text":""},{"location":"health-checks/sqlserver/#connectionstringorname","title":"ConnectionStringOrName","text":"<p>Gets or sets the SQL Server connection string or the name of a connection string.</p> <pre><code>{\n  \"ConnectionStrings\": { \"DefaultConnection\": \"Server=.;Database=MyDb;Trusted_Connection=True;\" },\n  \"Monivus\": { \"SqlServer\": { \"ConnectionStringOrName\": \"DefaultConnection\" } }\n}\n</code></pre>"},{"location":"health-checks/sqlserver/#commandtext","title":"CommandText","text":"<p>Gets or sets the SQL command text to be executed for the health check. Should be a very cheap scalar query (e.g., <code>SELECT 1</code>).</p> <pre><code>{\n  \"Monivus\": { \"SqlServer\": { \"CommandText\": \"SELECT 1\" } }\n}\n</code></pre>"},{"location":"health-checks/sqlserver/#commandtimeout","title":"CommandTimeout","text":"<p>Gets or sets the command timeout in seconds for the SQL command. If the command exceeds this timeout, the check returns Unhealthy with the corresponding exception.</p> <pre><code>{\n  \"Monivus\": { \"SqlServer\": { \"CommandTimeout\": 5 } }\n}\n</code></pre> <p>Example interpretation: if connecting runs and <code>SELECT 1</code> returns promptly, the check reports Healthy. If connecting or executing fails or times out, the check reports Unhealthy.</p>"},{"location":"health-checks/sqlserver/#example-entry-json","title":"Example Entry (JSON)","text":"<p><code>entries.SqlServer</code> inside the <code>/health</code> response when Healthy:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"SqlServer is healthy and running.\",\n  \"duration\": \"00:00:00.0100000\",\n  \"durationMs\": 10,\n  \"data\": {\n    \"connectionTimeout\": 15,\n    \"state\": 1,\n    \"commandTimeout\": 30,\n    \"connectionOpenMilliseconds\": 3.21,\n    \"queryDurationMilliseconds\": 1.45\n  },\n  \"exception\": null,\n  \"tags\": [\"SqlServer\", \"db\"],\n  \"entryType\": \"SqlServer\"\n}\n</code></pre>"},{"location":"health-checks/system/","title":"System Health Check","text":"<p>Monitors basic process/system health. Useful for a lightweight, always-on check.</p> <p>Status rules:</p> <ul> <li>Healthy when utilization is within configured thresholds.</li> <li>Degraded when a configured threshold is exceeded.</li> <li>This check does not return Unhealthy by itself; only operational errors would do so.</li> </ul>"},{"location":"health-checks/system/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.System\n</code></pre>"},{"location":"health-checks/system/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddSystemEntry(name: \"System\");\n</code></pre> <p>Then expose the endpoint:</p> <pre><code>app.UseMonivusHealthChecks(\"/health\");\n</code></pre>"},{"location":"health-checks/system/#configuration","title":"Configuration","text":"<p>App settings section: <code>Monivus:System</code></p>"},{"location":"health-checks/system/#memoryusagethresholdpercent","title":"MemoryUsageThresholdPercent","text":"<p>Percentage of total available memory used by the current process that triggers a degraded state.</p> <p>Behavior:</p> <ul> <li>Healthy when <code>MemoryUsageThresholdPercent</code> is not set, or the current usage is below the threshold.</li> <li>Degraded when current usage is greater than or equal to the threshold.</li> </ul> <p>Notes: - The percentage is computed using GC memory load versus total available memory and clamped to 0\u2013100.</p> <pre><code>{\n  \"Monivus\": {\n    \"System\": {\n      \"MemoryUsageThresholdPercent\": 85\n    }\n  }\n}\n</code></pre> <p>Example interpretation: if the process memory usage reaches 85% or higher of available memory, the check reports Degraded; otherwise Healthy.</p>"},{"location":"health-checks/system/#example-entries-json","title":"Example Entries (JSON)","text":"<p>Below are representative <code>entries.System</code> payloads from the <code>/health</code> endpoint. Field names reflect the implementation exactly.</p> <p>Healthy (typical):</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": \"System utilization within defined thresholds.\",\n  \"duration\": \"00:00:00.0010000\",\n  \"durationMs\": 1,\n  \"data\": {\n    \"ProcessName\": \"MyApp\",\n    \"Is64BitProcess\": true,\n    \"ProcessorCount\": 8,\n    \"UptimeSeconds\": 12345.67,\n    \"TotalProcessorTimeSeconds\": 321.45,\n    \"MemoryUsagePercent\": 42.1,\n    \"WorkingSetBytes\": 152043520,\n    \"WorkingSetMegabytes\": 145.32,\n    \"PrivateMemoryBytes\": 210763776,\n    \"PagedMemoryBytes\": 120258560,\n    \"PagedSystemMemoryBytes\": 35651584,\n    \"NonPagedSystemMemoryBytes\": 8388608,\n    \"EnvironmentWorkingSetBytes\": 160432128,\n    \"HandleCount\": 320,\n    \"ThreadCount\": 34,\n    \"PriorityClass\": \"Normal\",\n    \"GcTotalAllocatedBytes\": 987654321,\n    \"GcHeapSizeBytes\": 134217728,\n    \"GcFragmentedBytes\": 4194304,\n    \"GcCommittedBytes\": 167772160,\n    \"GcMemoryLoadBytes\": 6871947673,\n    \"GcHighMemoryLoadThresholdBytes\": 13743895347,\n    \"GcTotalAvailableMemoryBytes\": 13743895347,\n    \"GcCollectionsGen0\": 120,\n    \"GcCollectionsGen1\": 60,\n    \"GcCollectionsGen2\": 10,\n    \"GcPinnedObjectsCount\": 2,\n    \"GcGeneration\": 2,\n    \"GcPauseTimePercentage\": 0.25\n  },\n  \"exception\": null,\n  \"tags\": [\"System\"],\n  \"entryType\": \"System\"\n}\n</code></pre> <p>Degraded (memory usage exceeds threshold):</p> <pre><code>{\n  \"status\": \"Degraded\",\n  \"description\": \"Process memory usage 88.2% exceeds 85% threshold.\",\n  \"duration\": \"00:00:00.0010000\",\n  \"durationMs\": 1,\n  \"data\": {\n    \"ProcessName\": \"MyApp\",\n    \"Is64BitProcess\": true,\n    \"ProcessorCount\": 8,\n    \"UptimeSeconds\": 22345.11,\n    \"TotalProcessorTimeSeconds\": 654.21,\n    \"MemoryUsagePercent\": 88.2,\n    \"WorkingSetBytes\": 3221225472,\n    \"WorkingSetMegabytes\": 3072.0,\n    \"PrivateMemoryBytes\": 3758096384,\n    \"PagedMemoryBytes\": 3221225472,\n    \"PagedSystemMemoryBytes\": 67108864,\n    \"NonPagedSystemMemoryBytes\": 12582912,\n    \"EnvironmentWorkingSetBytes\": 3305111552,\n    \"HandleCount\": 420,\n    \"ThreadCount\": 45,\n    \"PriorityClass\": \"Normal\",\n    \"GcTotalAllocatedBytes\": 1987654321,\n    \"GcHeapSizeBytes\": 322122547,\n    \"GcFragmentedBytes\": 10485760,\n    \"GcCommittedBytes\": 402653184,\n    \"GcMemoryLoadBytes\": 12111807744,\n    \"GcHighMemoryLoadThresholdBytes\": 13743895347,\n    \"GcTotalAvailableMemoryBytes\": 13743895347,\n    \"GcCollectionsGen0\": 240,\n    \"GcCollectionsGen1\": 120,\n    \"GcCollectionsGen2\": 25,\n    \"GcPinnedObjectsCount\": 3,\n    \"GcGeneration\": 2,\n    \"GcPauseTimePercentage\": 0.35\n  },\n  \"exception\": null,\n  \"tags\": [\"System\"],\n  \"entryType\": \"System\"\n}\n</code></pre>"},{"location":"health-checks/url/","title":"URL Health Check","text":"<p>Validates that an HTTP/HTTPS endpoint responds as expected.</p> <p>Status rules:</p> <ul> <li>Healthy when the response status code is in the expected set (defaults to 2xx) and, if configured, the response time does not exceed the slow threshold.</li> <li>Degraded when the response status code is expected but the response time exceeds <code>SlowResponseThreshold</code>.</li> <li>Unhealthy when the response status code is not in the expected set, the request times out, or an exception occurs.</li> </ul>"},{"location":"health-checks/url/#install","title":"Install","text":"<pre><code>dotnet add package Monivus.HealthChecks.Url\n</code></pre>"},{"location":"health-checks/url/#usage","title":"Usage","text":"<pre><code>using Monivus.HealthChecks;\n\nbuilder.Services.AddHealthChecks()\n    .AddUrlEntry(name: \"Google\", url: \"https://www.google.com\");\n</code></pre> <p>You can also configure by name and omit <code>url</code>; the check reads <code>Monivus:Urls:{name}</code>.</p>"},{"location":"health-checks/url/#configuration","title":"Configuration","text":"<p>Binding path: <code>Monivus:Urls:{name}</code></p>"},{"location":"health-checks/url/#url","title":"Url","text":"<p>Gets or sets the absolute HTTP/HTTPS URL to monitor.</p> <pre><code>{\n  \"Monivus\": { \"Urls\": { \"Google\": { \"Url\": \"https://www.google.com\" } } }\n}\n</code></pre>"},{"location":"health-checks/url/#method","title":"Method","text":"<p>Gets or sets the HTTP method to use when making the request. Defaults to GET.</p> <pre><code>{\n  \"Monivus\": { \"Urls\": { \"Google\": { \"Method\": \"GET\" } } }\n}\n</code></pre>"},{"location":"health-checks/url/#requesttimeout","title":"RequestTimeout","text":"<p>Gets or sets the timeout duration for the HTTP request. This maps to <code>HttpClient.Timeout</code>. Use the <code>hh:mm:ss</code> TimeSpan format.</p> <pre><code>{\n  \"Monivus\": { \"Urls\": { \"Google\": { \"RequestTimeout\": \"00:00:05\" } } }\n}\n</code></pre>"},{"location":"health-checks/url/#expectedstatuscodes","title":"ExpectedStatusCodes","text":"<p>Gets or sets the set of expected HTTP status codes that indicate a healthy response.</p> <pre><code>{\n  \"Monivus\": { \"Urls\": { \"Google\": { \"ExpectedStatusCodes\": [200, 204] } } }\n}\n</code></pre>"},{"location":"health-checks/url/#slowresponsethreshold","title":"SlowResponseThreshold","text":"<p>Threshold duration for considering a response as slow (used to report Degraded). Use the <code>hh:mm:ss</code> TimeSpan format.</p> <pre><code>{\n  \"Monivus\": {\n    \"Urls\": {\n      \"Google\": {\n        \"Url\": \"https://www.google.com\",\n        \"Method\": \"GET\",\n        \"RequestTimeout\": \"00:00:05\",\n        \"ExpectedStatusCodes\": [200, 204],\n        \"SlowResponseThreshold\": \"00:00:02\"\n      }\n    }\n  }\n}\n</code></pre> <p>Example interpretation: responses with 2xx are Healthy unless they take longer than 2 seconds, in which case the check reports Degraded. Non-expected status codes or timeouts are Unhealthy.</p>"},{"location":"health-checks/url/#example-entry-json","title":"Example Entry (JSON)","text":"<p><code>entries.Google</code> inside the <code>/health</code> response when Healthy and quick:</p> <pre><code>{\n  \"status\": \"Healthy\",\n  \"description\": null,\n  \"duration\": \"00:00:00.0060000\",\n  \"durationMs\": 6,\n  \"data\": {\n    \"url\": \"https://www.google.com\",\n    \"method\": \"GET\",\n    \"statusCode\": 200,\n    \"reasonPhrase\": \"OK\"\n  },\n  \"exception\": null,\n  \"tags\": [\"Url\"],\n  \"entryType\": \"Url\"\n}\n</code></pre>"}]}